<div
  [ngClass]="['trmrk-short-string-editor', trmrkCssClass ?? '']"
  (trmrkTouchStartOrMouseDown)="containerTouchStartOrMouseDown($event)"
>
  <ng-container *ngTemplateOutlet="trmrkLeadingTemplate"></ng-container>
  @if (trmrkAllowDeleteChar) {
  <div class="trmrk-icon-wrapper">
    <button
      mat-icon-button
      class="trmrk-icon-btn"
      (trmrkLongPressOrRightClick)="charDeleteBtnLongPressOrRightClick($event)"
      (trmrkShortPressOrLeftClick)="charDeleteBtnShortPressOrLeftClick($event)"
    >
      <mat-icon class="trmrk-icon">delete</mat-icon>
    </button>
  </div>
  } @if (trmrkAllowInsertChar || !chars.length) {
  <div class="trmrk-icon-wrapper">
    <button
      mat-icon-button
      class="trmrk-icon-btn"
      (trmrkLongPressOrRightClick)="charInsertBtnLongPressOrRightClick($event, false)"
      (trmrkShortPressOrLeftClick)="charInsertBtnShortPressOrLeftClick($event, false)"
    >
      <mat-icon class="trmrk-icon">space_bar</mat-icon>
    </button>
  </div>
  } @if (trmrkAllowDeleteChar) {
  <div class="trmrk-icon-wrapper">
    <button
      mat-icon-button
      class="trmrk-icon-btn"
      (trmrkLongPressOrRightClick)="charBackspaceBtnLongPressOrRightClick($event)"
      (trmrkShortPressOrLeftClick)="charBackspaceBtnShortPressOrLeftClick($event)"
    >
      <mat-icon class="trmrk-icon">backspace</mat-icon>
    </button>
  </div>
  } @for (char of chars; track char.id) {
  <ng-container
    *ngTemplateOutlet="trmrkBeforeCharWrapperTemplate; context: { char, idx: $index }"
  ></ng-container>

  <div
    [ngClass]="[
      'trmrk-char-wrapper',
      trmrkFocusedCharIdx === $index ? 'trmrk-focused-char' : '',
      trmrkCharCssClassFactory ? trmrkCharCssClassFactory(char.value, $index) : ''
    ]"
    (trmrkLongPressOrRightClick)="charLongPressOrRightClick($event, $index)"
    (trmrkShortPressOrLeftClick)="charShortPressOrLeftClick($event, $index)"
  >
    @if (!trmrkUseCharTemplate) {
    <span class="trmrk-char-btn">
      @if (char.isWhitespace) { &nbsp; } @if (!char.isWhitespace) { {{ char.value }} }
    </span>
    } @if (trmrkUseCharTemplate) {
    <ng-container
      *ngTemplateOutlet="trmrkCharTemplate; context: { char: char.value, idx: $index }"
    ></ng-container>
    }
  </div>

  <ng-container
    *ngTemplateOutlet="trmrkAfterCharWrapperTemplate; context: { char, idx: $index }"
  ></ng-container>
  } @if (trmrkAllowInsertChar) {
  <div class="trmrk-icon-wrapper">
    <button
      mat-icon-button
      class="trmrk-icon-btn"
      (trmrkLongPressOrRightClick)="charInsertBtnLongPressOrRightClick($event, true)"
      (trmrkShortPressOrLeftClick)="charInsertBtnShortPressOrLeftClick($event, true)"
    >
      <mat-icon class="trmrk-icon">space_bar</mat-icon>
    </button>
  </div>
  }
  <ng-container *ngTemplateOutlet="trmrkBeforeDoneBtnTemplate"></ng-container>
  @if (trmrkShowDoneBtn) {
  <div [ngClass]="'trmrk-icon-wrapper'">
    <button
      mat-icon-button
      class="trmrk-icon-btn"
      (trmrkTouchStartOrMouseDown)="doneBtnTouchStartOrMouseDown($event)"
    >
      <mat-icon class="trmrk-icon">done</mat-icon>
    </button>
  </div>
  } @if (trmrkShowCopyToClipboardBtn) {
  <div [ngClass]="'trmrk-icon-wrapper'">
    <button mat-icon-button class="trmrk-icon-btn" (click)="copyToClipboardClicked()">
      <mat-icon class="trmrk-icon">content_copy</mat-icon>
    </button>
  </div>
  } @if (trmrkShowPasteFromClipboardBtn) {
  <div [ngClass]="'trmrk-icon-wrapper'">
    <button mat-icon-button class="trmrk-icon-btn" (click)="pasteFromClipboardClicked()">
      <mat-icon class="trmrk-icon">content_paste</mat-icon>
    </button>
  </div>
  }
  <div class="trmrk-fake-input-container">
    <input
      class="trmrk-fake-input"
      type="text"
      [inputMode]="trmrkDigitsOnly ? 'decimal' : 'text'"
      enterkeyhint="go"
      #fakeNumberInput
      [trmrkDynamicAttributes]="trmrkInputAttrs ?? {}"
    />
  </div>
  <trmrk-user-message
    class="trmrk-copied-to-clipboard-success-message"
    [trmrkMessage]="'Copied!'"
    [trmrkShow]="showCopiedToClipboardSuccessMessage"
    [trmrkLevel]="UserMessageLevel.Success"
    [trmrkAutoCloseMillis]="1000"
  ></trmrk-user-message>
  <ng-container *ngTemplateOutlet="trmrkTrailingTemplate"></ng-container>
</div>
