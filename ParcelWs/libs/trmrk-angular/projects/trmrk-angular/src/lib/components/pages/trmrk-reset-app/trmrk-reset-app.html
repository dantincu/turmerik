<trmrk-app-page
  [trmrkPageTemplate]="page"
  [trmrkAppBarTitle]="trmrkResetAppService.isResetting ? 'Resetting the app...' : 'App Reset'"
></trmrk-app-page>

<ng-template #page>
  @if (trmrkResetAppService.showTopHorizStrip) {
  <trmrk-horiz-strip
    [trmrkCssClass]="[
      'trmrk-top-message-horiz-strip trmrk-has-border-x2',
      trmrkResetAppService.showErrorMessage ? 'trmrk-error-message-horiz-strip' : ''
    ]"
    [trmrkLeadingTemplate]="topHorizStripLeadingTemplate"
    [trmrkMainText]="
      trmrkResetAppService.showErrorMessage ? 'An error occurred while resetting the app' : ''
    "
    [trmrkDetailsTextParts]="
      trmrkResetAppService.showErrorMessage ? [trmrkResetAppService.errorMessage!] : null
    "
    [trmrkTrailingTemplate]="trmrkErrorHorizStripTrailingTemplate"
  ></trmrk-horiz-strip>
  <ng-template #trmrkErrorHorizStripTrailingTemplate>
    @if (trmrkResetAppService.showErrorMessage) {
    <button mat-icon-button class="trmrk-icon-btn" (click)="trmrkResetAppService.closeError()">
      <mat-icon class="trmrk-icon">close</mat-icon>
    </button>
    }
  </ng-template>
  }
  <div class="trmrk-page-body trmrk-page-body-thin">
    @if (!trmrkResetAppService.isResetting) {
    <a
      mat-button
      mat-button
      class="trmrk-btn"
      [routerLink]="
        trmrkResetAppService.router.createUrlTree([], { queryParams: { reset: 'true' } })
      "
      >Reset</a
    >
    }
  </div>
</ng-template>

<ng-template #topHorizStripLeadingTemplate>
  @if (trmrkResetAppService.isResetting) {
  <trmrk-loading></trmrk-loading>
  }
  <trmrk-user-message
    class="trmrk-app-reset-success-message"
    [trmrkMessage]="'The app has been reset'"
    [trmrkShow]="trmrkResetAppService.showSuccessMessage"
    [trmrkLevel]="UserMessageLevel.Success"
    (trmrkClose)="trmrkResetAppService.navToBaseRoute()"
  ></trmrk-user-message>
</ng-template>
