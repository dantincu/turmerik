<div
  [ngClass]="['trmrk-app-panel', panelListService.hasPendingReorder ? 'trmrk-has-bottom-horiz-strip' : '', trmrkCssClass ?? '', panelListService.showAcceleratingScrollPopovers ? 'trmrk-has-accelerating-popovers' : '']"
>
  @if (!panelListService.showAcceleratingScrollPopovers) {
  <div
    class="trmrk-horiz-strip trmrk-has-border-x2 trmrk-top-horiz-strip"
    #topHorizStrip
  >
    @if (panelListService.rowsAreSelectable) {
    <button mat-icon-button class="trmrk-icon-btn">
      <mat-checkbox
        class="trmrk-checkbox"
        (change)="rowsMasterCheckBoxToggled($event)"
        [checked]="panelListService.rowsMasterCheckBoxIsChecked"
      ></mat-checkbox>
    </button>
    }
    <trmrk-accelerating-scroll-control
      [trmrkScrollable]="getPanelList"
    ></trmrk-accelerating-scroll-control>
  </div>
  } @if (panelListService.showAcceleratingScrollPopovers) {
  <trmrk-accelerating-scroll-popover
    #upAcceleratingScrollPopover
    [trmrkFocusedPadIdx]="panelListService.acceleratingScrollPadIdx"
  ></trmrk-accelerating-scroll-popover>
  }

  <trmrk-panel-list
    #panelList
    [topHorizStrip]="getTopHorizStrip"
    [trmrkEntities]="trmrkEntities"
    [trmrkEntityKeyPropName]="trmrkEntityKeyPropName"
    [trmrkRowsSelectionIsAllowed]="trmrkRowsSelectionIsAllowed"
    [trmrkSelectedRowsReorderIsAllowed]="trmrkSelectedRowsReorderIsAllowed"
    [trmrkSelectedRowsReorderAggRowVertIsOriented]="trmrkSelectedRowsReorderAggRowVertIsOriented"
    [trmrkUpAcceleratingScrollPopover]="getUpAcceleratingScrollPopover"
    [trmrkDownAcceleratingScrollPopover]="getDownAcceleratingScrollPopover"
    [trmrkListItems]="trmrkListItems"
    [trmrkVisuallyMovingListItems]="trmrkVisuallyMovingListItems"
    (trmrkRowsUpdated)="trmrkRowsUpdated.emit($event)"
    [trmrkRowMenuTemplate]="trmrkRowMenuTemplate"
    [trmrkRowTemplate]="trmrkRowTemplate"
    [trmrkVisuallyMovingRowTemplate]="trmrkVisuallyMovingRowTemplate"
  ></trmrk-panel-list>

  @if (!panelListService.showAcceleratingScrollPopovers) { @if
  (panelListService.hasPendingReorder) {
  <trmrk-horiz-strip
    [trmrkCssClass]="['trmrk-bottom-horiz-strip trmrk-has-border-x2']"
    [trmrkMainText]="'Apply new order'"
    [trmrkTrailingTemplate]="bottomHorizStripTrailingTemplate"
  ></trmrk-horiz-strip>
  <ng-template #bottomHorizStripTrailingTemplate>
    <button mat-icon-button class="trmrk-icon-btn trmrk-icon-btn-filled-accept">
      <mat-icon class="trmrk-icon">check</mat-icon>
    </button>
    <button mat-icon-button class="trmrk-icon-btn trmrk-icon-btn-filled-reject">
      <mat-icon class="trmrk-icon">cancel</mat-icon>
    </button>
  </ng-template>
  } } @if (panelListService.showAcceleratingScrollPopovers) {
  <trmrk-accelerating-scroll-popover
    #downAcceleratingScrollPopover
    [trmrkHasCancelBtn]="true"
    [trmrkFocusedPadIdx]="panelListService.acceleratingScrollPadIdx - 3"
    [trmrkCancelBtnIsFocused]="panelListService.downAcceleratingPopoverCancelBtnIsFocused"
  ></trmrk-accelerating-scroll-popover>
  }
</div>
